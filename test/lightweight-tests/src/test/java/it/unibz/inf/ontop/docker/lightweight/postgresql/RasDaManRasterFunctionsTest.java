package it.unibz.inf.ontop.docker.lightweight.postgresql;

import com.google.common.collect.ImmutableList;
import it.unibz.inf.ontop.docker.lightweight.AbstractDockerRDF4JTest;
import org.junit.jupiter.api.AfterAll;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.sql.SQLException;

public class RasDaManRasterFunctionsTest extends AbstractDockerRDF4JTest {
    private static final String PROPERTIES_FILE = "/rasdaman/rasdaman.properties";
    private static final String OBDA_FILE = "/rasdaman/OntoRaster.obda";
    private static final String OWL_FILE = "/rasdaman/rasdaman.owl";

    @BeforeAll
    public static void before() throws IOException, SQLException {
        initOBDA(OBDA_FILE, OWL_FILE, PROPERTIES_FILE);
    }

    @AfterAll
    public static void after() throws SQLException {
        release();
    }

    //////////////////////////////
    ////// rasdaman.obda ///////
    //////////////////////////////
    @Test
    public void averageRasterSPATIAL() {

        String query3 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?r rdfs:label ?region_name .\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "?x rasdb:hasScaleFactor ?ras_sf .\n"
                + "?r geo:asWKT ?region .\n"
                + "FILTER (?region_name = 'Deggendorf'\n)"
//                + "FILTER (contains(?raster_name,'Bavaria')) .\n" Regen Erding Kelheim
                + "BIND (rasdb:rasSpatialAverage(100, ?ras_sf, ?region, ?raster_name) AS ?v)"
                + "}\n";

        executeAndCompareValues(query3, ImmutableList.of("\"274.998\"^^xsd:double"));
    }

    @Test
    public void maxRasterSPATIAL() {

        String query4 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?r rdfs:label ?region_name .\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "?x rasdb:hasScaleFactor ?ras_sf .\n"
                + "?r geo:asWKT ?region .\n"
                + "FILTER (?region_name = 'Deggendorf'\n)"
                + "BIND (rasdb:rasSpatialMaximum(100, ?ras_sf, ?region, ?raster_name) AS ?v)"
                + "}\n";

        executeAndCompareValues(query4, ImmutableList.of("\"277.08\"^^xsd:double"));
    }

    @Test
    public void minRasterSPATIAL() {

        String query5 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?r rdfs:label ?region_name .\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "?x rasdb:hasScaleFactor ?ras_sf .\n"
                + "?r geo:asWKT ?region .\n"
                + "FILTER (?region_name = 'Deggendorf'\n)"
                + "BIND (rasdb:rasSpatialMinimum(100, ?ras_sf, ?region, ?raster_name) AS ?v)"
                + "}\n";

        executeAndCompareValues(query5, ImmutableList.of("\"272.88\"^^xsd:double"));
    }

    //////////////////////////////
    ////// OntoRaster.obda ///////
    //////////////////////////////

    @Test
    public void testConnection() {

        String query1 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT * {\n"
                + "?x rasdb:hasConnection ?v .\n"
                + "}\n";

        executeAndCompareValues(query1, ImmutableList.of("\"RasDaMan is connected\"^^xsd:string"));
    }

    @Test
    public void getRasterArrayTemporal() {

        String query7 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "FILTER (?raster_name = 'Surface_Temperature_Sweden'\n)"
                + "BIND (rasdb:rasSmallRasterArrayTemp(49,50, ?raster_name) AS ?v)" //%s %s %s
                + "}\n";

        executeAndCompareValues(query7, ImmutableList.of("\"{{{0,0,0},{0,0,0},{0,0,0}},{{0,0,0},{0,0,0},{0,0,0}}}\"^^xsd:string")); //Array issue in RDF @Diego
    }

    @Test
    public void getRasterArraySpatial() {

        String query8 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "FILTER (?raster_name = 'South_Tyrol_Temperature_MODIS_1km'\n)"
                + "BIND (rasdb:rasSmallRasterArraySpatial(49, ?raster_name) AS ?v)" //%s %s
                + "}\n";

        executeAndCompareValues(query8, ImmutableList.of("\"{{0,0,0},{0,0,0},{0,0,0}}\"^^xsd:string")); //Array issue in RDF @Diego
    }

//    @Test
//    public void minRasterSPATIALX() {
//
//        String query9 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
//                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
//                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
//                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
//                + "SELECT ?v {\n"
//                + "?r rdfs:label ?region_name .\n"
//                + "?r geo:asWKT ?region .\n"
//                + "?x rasdb:hasRasterName ?raster_name .\n"
//                + "FILTER (?region_name = 'Deggendorf'\n)" //Regen Erding Kelheim Linköping
//                + "FILTER (?raster_name = 'Baveria_Temperature_MODIS_1km'\n)" //Baveria_Temperature_MODIS_1km, Surface_Temperature_Sweden, South_Tyrol_Temperature_MODIS_1km
//                + "BIND (rasdb:rasSpatialMinimumX(100, ?region, ?raster_name) AS ?v)"
//                + "}\n";
//
//        executeAndCompareValues(query9, ImmutableList.of("\"13644\"^^xsd:integer"));
//    }

//    @Test
//    public void minRasterSPATIALX() {
//
//        String query10 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
//                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
//                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
//                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
//                + "SELECT ?v {\n"
//                + "?r rdfs:label ?region_name .\n"
//                + "?r geo:asWKT ?region .\n"
//                + "?x rasdb:hasRasterName ?raster_name .\n"
//                + "?x rasdb:rasdb:hasMinLongitude ?min_lon .\n"
//                + "?x rasdb:hasMaxLatitude ?max_lat .\n"
//                + "?x rasdb:rasdb:hasSpatialResolution_lon ?x_scale .\n"
//                + "?x rasdb:rasdb:hasSpatialResolution_lat ?y_scale .\n"
//                + "FILTER (?region_name = 'Deggendorf'\n)" //Vector region = Regen Erding, Kelheim, Linköping,
//                //+ "FILTER (?raster_name = 'Baveria_Temperature_MODIS_1km'\n)" //Raster Dataset = Baveria_Temperature_MODIS_1km, Surface_Temperature_Sweden, South_Tyrol_Temperature_MODIS_1km
//                + "BIND (rasdb:rasSpatialMinimumX(100, ?region, ?min_lon, ?max_lat, ?x_scale, ?y_scale, ?raster_name) AS ?v)"
//                + "}\n";
//
//        executeAndCompareValues(query10, ImmutableList.of("\"13644\"^^xsd:integer"));
//    }

    @Test
    public void clipRaster() {
        String query9 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
                + "SELECT ?v {\n"
                + "?r rdfs:label ?region_name .\n"
                + "?r geo:asWKT ?region .\n"
                + "?x rasdb:hasRasterName ?raster_name .\n"
                + "FILTER (?region_name = 'Deggendorf'\n)"
                + "FILTER (?raster_name = 'Baveria_Temperature_MODIS_1km'\n)"
                + "BIND (rasdb:rasClipRaster(100, ?region, ?raster_name) AS ?v)"
                + "}\n";

        executeAndCompareValues(query9, ImmutableList.of("\"{{0,0,0,0,0,0,0,0,0,0,0,0,0,0,13749,0,0,13755,13754,0,0,0,0,0,0,0,0,13660,13660,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,13766,13769,13776,13776,13770,0,0,0,0,0,0,13721,13713,13707,13707,13706,13728,13728,13743,13727,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,13801,13801,13809,13812,13812,13798,13786,13786,13782,13782,13782,13756,13737,13737,13737,13733,13733,13741,13746,13746,13731,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,13803,13803,13803,13804,13804,13804,13818,13821,13821,13816,13816,13809,13781,13781,13779,13760,13760,13763,13743,13743,13735,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,13798,13798,13795,13793,13793,13805,13803,13803,13804,13803,13803,13775,13769,13769,13790,13796,13796,13739,13726,13726,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,13737,13756,13756,13774,13776,13776,13779,13788,13788,13799,13799,13788,13778,13778,13790,13802,13802,13761,13731,0,13716,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,13736,13741,13747,13747,13768,13766,13766,13761,13769,13769,13809,13806,13806,13793,13794,13794,13802,13780,13780,13739,13729,13729,13711,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,13739,13740,13743,13743,13741,13757,13757,13756,13754,13754,13753,13794,13794,13798,13798,13774,13768,13768,13777,13779,13779,13753,13743,13743,13717,13714,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,13706,13706,13712,13716,13716,13729,13737,13737,13749,13753,13753,13760,13775,13775,13791,13784,13784,13775,13773,13773,13770,13754,13754,13738,13725,13725,13716,13713,0,0,0,0,13673,0,13671,13653,13653,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,13708,13708,13710,13733,13733,13738,13755,13755,13762,13772,13772,13771,13772,13772,13772,13772,13780,13779,13779,13758,13753,13753,13742,13740,13740,13729,13731,13731,13727,13729,13729,13722,13721,13721,13693,13688,13688,13644,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,13714,13714,13713,13731,13731,13738,13758,13758,13763,13770,13770,13770,13761,13761,13758,13775,13775,13780,13776,13776,13774,13753,13753,13748,13742,13742,13739,13740,13740,13742,13740,13740,13742,13742,13729,13720,13720,13715,13670,13670,13675,13670,13670,13679,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,13721,13717,13717,13720,13721,13721,13743,13767,13767,13773,13779,13779,13770,13770,13757,13767,13767,13779,13778,13778,13778,13768,13768,13753,13753,13753,13756,13761,13761,13773,13775,13775,13767,13767,13767,13776,13777,13777,13718,13718,13718,13706,13707,13707,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,13727,13724,13724,13728,13722,13722,13732,13767,13767,13765,13780,13780,13779,13799,13799,13805,13773,13773,13772,13770,13770,13770,13755,13755,13753,13757,13757,13754,13752,13752,13746,13747,13747,13747,13747,13737,13726,13726,13756,13785,13785,13762,13738,13738,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,13788,13797,13797,13782,13778,13778,13762,13757,13757,13781,13797,13797,13813,13813,13818,13793,13793,13780,13768,13768,13761,13744,13744,13737,13735,13735,13734,13727,13727,13721,13728,13728,13743,13739,13739,13725,13732,13732,13748,13739,13739,13725,13718,13718,0,0,0,0,0,0},{0,0,13744,13744,0,0,0,0,0,0,0,13764,13767,13759,13759,13753,13749,13749,13754,13763,13763,13805,13854,13854,13845,13830,13830,13812,13779,13779,13767,13750,13750,13746,13745,13745,13744,13740,13740,13739,13729,13729,13729,13747,13747,13747,13747,13729,13730,13730,13740,13747,13747,13739,13741,0,0,0,0,0,0,0},{0,13713,13732,13732,13768,13776,0,0,0,13790,13793,13776,13776,13737,13743,13743,13758,13763,13763,13764,13773,13773,13809,13807,13807,13848,13848,13839,13759,13759,13756,13735,13735,13737,13750,13750,13750,13737,13737,13735,13743,13743,13748,13748,13748,13746,13752,13752,13755,13779,13779,13792,13771,13771,13760,0,0,0,0,0,0,0},{13701,13701,13703,13739,13739,13734,13734,13755,13750,13750,13770,13767,13767,13755,13755,13755,13789,13789,13789,13769,13773,13773,13781,13776,13776,13814,13817,13817,13781,13777,13777,13758,13755,13755,13753,13752,13752,13735,13728,13728,13746,13759,13759,13755,13751,13751,13755,13755,13760,13773,13773,13786,13763,13763,13729,13731,13731,0,0,0,0,0},{0,13685,13681,13701,13701,13705,13727,13727,13729,13747,13747,13749,13735,13735,13728,13741,13741,13743,13789,13789,13812,13772,13772,13748,13775,13775,13793,13793,13788,13788,13788,13774,13761,13761,13757,13747,13747,13744,13737,13737,13742,13755,13755,13756,13758,13758,13759,13766,13766,13772,13777,13777,13769,13737,13737,13735,13744,13744,13747,13756,0,0},{0,0,13679,13693,13703,13703,13705,13705,13707,13721,13721,13731,13723,13723,13719,13726,13726,13735,13750,13750,13769,13755,13755,13743,13750,13750,13772,13781,13781,13796,13791,13791,13774,13771,13771,13754,13749,13749,13744,13743,13743,13747,13749,13749,13757,13761,13761,13767,13767,13769,13767,13767,13764,13747,13747,13739,13743,13743,13747,13750,0,0},{0,13690,13690,13695,13699,13699,13703,13716,13716,13713,13697,13697,13700,13715,13715,13717,13727,13727,13734,13750,13750,13755,13755,13755,13759,13774,13774,13780,13780,13790,13793,13793,13781,13773,13773,13762,13752,13752,13751,13748,13748,13744,13741,13741,13747,13758,13758,13760,13762,13762,13757,13748,13748,13746,13737,13737,13736,13738,13738,13736,0,0},{0,0,13704,13704,13698,13697,13697,13710,13710,13713,13709,13709,13707,13732,13732,13744,13766,13766,13777,13777,13777,13781,13780,13780,13777,13775,13775,13764,13774,13774,13798,13796,13796,13782,13767,13767,13738,13735,13735,13732,13729,13729,13728,13731,13731,13737,13738,13738,13752,13754,13754,13744,13744,13743,13738,13738,13736,13741,13741,13746,0,0},{0,0,0,13708,13701,13698,13698,13704,13709,13709,13716,13734,13734,13753,13781,13781,13790,13803,13803,13792,13777,13777,13778,13781,13781,13780,13775,13775,13779,13779,13795,13798,13798,13780,13765,13765,13729,13724,13724,13723,13722,13722,13726,13732,13732,13739,13746,13746,13750,13753,13753,13749,13741,13741,13747,13762,13762,13763,0,0,0,0},{0,0,13713,13713,13713,13713,13713,13713,13715,13715,13716,13733,13733,13745,13785,13785,13793,13786,13786,13774,13752,13752,13751,13769,13769,13772,13772,13772,13770,13782,13782,13791,13782,13782,13779,13772,13772,13763,13749,13749,13720,13726,13726,13740,13744,13744,13759,13757,13757,13751,13749,13749,13736,13736,13735,13754,13754,13752,13752,13752,0,0},{0,0,13714,13716,13716,13716,13713,13713,13711,13712,13712,13727,13738,13738,13771,13790,13790,13778,13773,13773,13764,13754,13754,13748,13735,13735,13737,13740,13740,13754,13754,13783,13784,13784,13794,13789,13789,13764,13759,13759,13735,13738,13738,13732,13731,13731,13746,13747,13747,13746,13746,13746,13733,13730,13730,13740,13741,13741,13738,13734,13734,13733},{0,0,0,13703,13706,13706,13716,13715,13715,13711,13711,13726,13755,13755,13762,13777,13777,13779,13778,13778,13769,13749,13749,13745,13743,13743,13744,13734,13734,13734,13746,13746,13744,13794,13794,13795,13760,13760,13757,13748,13748,13748,13735,13735,13731,13741,13741,13745,13741,13741,13738,13735,13735,13734,13734,13728,13719,13719,13718,13717,13717,0},{0,0,0,13696,13702,13702,13719,13718,13718,13714,13718,13718,13757,13757,13757,13734,13729,13729,13746,13746,13746,13732,13732,13732,13749,13751,13751,13738,13736,13736,13752,13752,13760,13783,13783,13791,13782,13782,13779,13765,13765,13755,13743,13743,13732,13737,13737,13746,13746,13746,13743,13743,13743,13734,13735,13735,13742,13745,13745,13745,13747,13747},{0,0,0,0,0,13715,13715,13712,13712,13717,13718,13718,13750,13759,13759,13732,13722,13722,13733,13736,13736,13734,13735,13735,13749,13758,13758,13750,13743,13743,13757,13769,13769,13778,13795,13795,13793,13786,13786,13784,13777,13777,13779,13782,13782,13782,13764,13764,13763,13756,13756,13756,13736,13736,13735,13735,13747,13749,13749,13736,13728,13728},{0,0,0,0,0,0,0,13680,13697,13697,13715,13739,13739,13761,13740,13740,13716,13723,13723,13734,13736,13736,13738,13744,13744,13751,13745,13745,13733,13735,13735,13747,13747,13756,13808,13808,13807,13793,13793,13792,13794,13794,13798,13801,13801,13804,13773,13773,13770,13748,13748,13737,13735,13735,13734,13738,13738,13738,13730,13730,13718,13722},{0,0,0,0,0,13674,13681,13681,13698,13698,13746,13754,13754,13764,13752,13752,13703,13709,13709,13738,13738,13738,13743,13743,13743,13745,13743,13743,13731,13731,13731,13752,13754,13754,13777,13777,13777,13781,13788,13788,13807,13815,13815,13812,13806,13806,13788,13774,13774,13764,13742,13742,13739,13732,13732,13736,13736,13740,13738,13738,13724,13727},{0,0,0,0,0,13691,13691,13691,13694,13764,13764,13762,13747,13747,13741,13712,13712,13714,13724,13724,13723,13736,13736,13736,13729,13729,13731,13731,13731,13734,13746,13746,13755,13755,13760,13768,13768,13767,13776,13776,13779,13791,13791,13788,13785,13785,13782,13770,13770,13766,13752,13752,13749,13740,13740,13743,13747,13747,13746,13735,13735,0},{0,0,0,0,0,0,0,13783,13783,13760,13760,13739,13721,13721,13713,13717,13717,13720,13719,13719,13719,13725,13725,13726,13721,13721,13721,13726,13726,13737,13743,13743,13763,13762,13762,13750,13746,13746,13746,13751,13751,13772,13776,13776,13777,13776,13776,13760,13755,13755,13760,13762,13762,13762,13762,13762,13755,0,0,0,0,0},{0,0,0,0,0,0,0,13779,13779,13772,13736,13736,13736,13732,13732,13729,13720,13720,13717,13716,13716,13719,13727,13727,13724,13718,13718,13721,13735,13735,13737,13746,13746,13746,13746,13727,13719,13719,13757,13769,13769,13770,13768,13768,13767,13770,13770,13760,13749,0,13757,0,13768,13766,13760,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,13758,13754,13754,13756,13752,13752,13750,13737,13737,13737,13724,13724,13725,13719,13719,13716,13718,13718,13720,13732,13732,13732,13730,13730,13733,13722,13722,13710,13733,13733,13769,13766,13766,13771,13774,13774,13781,13780,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,13759,13758,13759,13759,13770,13771,13771,13763,13761,13761,13744,13735,13735,13727,13713,13713,13714,13715,13715,13711,13706,13706,13705,13714,13714,13710,13710,13697,13696,13696,13735,13735,13735,13781,13785,13785,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,13756,13752,13747,13747,13746,13759,13759,13761,13778,13778,13775,13705,13705,13705,13692,13692,13692,13691,13691,13693,13708,13708,13710,13707,13707,13709,13728,13728,13735,13763,13763,13778,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,13737,13725,13724,13724,13754,13754,13754,13781,13785,13785,13760,13764,13764,13731,13721,13721,13714,13710,13710,13713,13714,13714,13716,13721,13721,13728,13728,13732,13745,13745,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13744,13769,13784,13784,13784,13787,13787,13764,13749,13749,13747,13743,13743,13753,13768,13768,13767,13749,13749,13744,13727,13727,13730,13753,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13745,0,13783,13782,13782,13780,13776,13776,13764,13767,13767,13779,13779,13779,13765,13768,13768,13761,13761,13764,13758,13758,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13739,13733,13733,13756,13756,13756,13778,13780,13780,13783,13784,13784,13778,13778,13778,13776,13778,13778,13769,13761,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13722,13722,13726,13735,13735,13736,13739,13739,13736,13739,13739,13753,13764,13764,13778,13779,13779,13784,13784,13780,13758,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13756,13756,13735,13732,13732,13727,13727,13727,13720,13719,13719,0,13745,13745,13757,13756,13756,13754,13750,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13750,13746,13736,13736,13734,13711,13711,13704,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13736,13732,13719,13719,13702,13709,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,13737,0,13703,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}}\"^^xsd:string")); //xsd:array is not available
    }


//    @Test
//    public void clipRasterWithCustomGeometry() {
//
//        String query6 = "PREFIX :\t<http://www.semanticweb.org/arkaghosh/OntoRaster/>\n"
//                + "PREFIX rdfs:\t<http://www.w3.org/2000/01/rdf-schema#>\n"
//                + "PREFIX geo:\t<http://www.opengis.net/ont/geosparql#>\n"
//                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
//                + "SELECT ?v {\n"
//                + "?x rasdb:hasRasterName ?raster_name .\n"
//                + "?r geo:asWKT ?region .\n"
//                + "FILTER (?region = 'POLYGON((11.324157714843748 48.29050321714061,11.911926269531248 48.279537342260085,11.88995361328125 48.01932418480118,11.340637207031248 48.01564978668938,11.324157714843748 48.29050321714061))'\n)"
//                + "BIND (rasdb:rasClipRasterXGeom(246, ?region, ?raster_name) AS ?v)"
//                + "}\n";
//
//        executeAndCompareValues(query6, ImmutableList.of("\"{{291.48,291.48,289.32,286.94,286.94,286.86,286.78000000000003,286.78000000000003,287,287.3,287.3,286.8,285.56,285.56,285.76,286.64,286.64,287.52,287.82,287.82,285.94,285.8,285.8,285.94,287.06,287.06,287.8,286.54,286.54,286.2,286.36,286.36,286.18,285.56,285.56,285.62,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{292.16,292.16,289.3,287.64,287.64,287.72,287.66,287.66,287.3,287.2,287.2,286.8,285.90000000000003,285.92,285.92,287.56,287.6,287.6,287.68,285.84000000000003,285.84000000000003,285.86,285.96,285.96,287.36,287.14,287.14,286.2,285.92,285.92,286.46,286.7,286.7,286.5,286.72,286.72,286.56,286.58,286.58,286.5,285.98,285.98,286.1,285.66,285.66,285.04,284.66,284.66,284.78000000000003,285.06,285.06,285.1,285.2,285.2,285.2,285.14,285.14,285.26,285.5,285.5,285.5,284.44,284.44,285.40000000000003,285.84000000000003,285.84000000000003,285.88,285.86,285.86,285.14,285.12},{292.28000000000003,290.16,290.16,288.3,287.76,287.76,287.6,286.94,286.94,287.32,286.06,286.06,285.8,285.90000000000003,285.90000000000003,286.18,286.58,286.58,287.36,0,0,285.88,286.54,286.54,286.82,286.7,286.7,286.3,285.98,285.98,286.38,286.14,286.14,285.94,286.28000000000003,286.28000000000003,286.62,286.5,286.5,286.38,286.14,286.14,286.22,285.8,285.8,284.62,284.1,284.1,284.14,284.26,284.26,285.06,285.62,285.62,285.52,285.2,285.28000000000003,285.28000000000003,284.8,284.94,284.94,285.44,285.68,285.68,285.8,285.90000000000003,285.90000000000003,285.5,285.90000000000003,285.90000000000003,285.92},{292.32,291.16,291.16,288.92,288.22,288.22,288.14,287.90000000000003,287.90000000000003,287.44,286.26,286.26,285.56,285.90000000000003,285.90000000000003,286.6,287.44,287.44,287.36,287.36,0,0,286.84000000000003,287.2,287.2,287.08,286.82,286.82,286.62,286.48,286.48,286.24,285.8,285.8,285.78000000000003,286.34000000000003,286.34000000000003,286.6,286.48,286.48,285.78000000000003,284.84000000000003,284.84000000000003,284.90000000000003,284.5,284.5,284.2,284.2,284.2,284.28000000000003,284.36,284.36,284.68,285.92,285.92,285.74,285.8,285.8,285.1,284.16,284.16,283.74,284.40000000000003,284.40000000000003,285.76,286.02,286.02,285.34000000000003,285.06,285.06,285.46},{292.96,291.94,289.48,289.48,288.62,288.46,288.46,288.38,287.78000000000003,287.78000000000003,286.52,285.7,285.7,286.04,286.82,286.82,287.26,287.26,287.26,287.42,287.54,287.54,287.98,287.8,287.8,287.3,286.90000000000003,286.90000000000003,286.92,286.64,286.64,286.22,286.08,286.08,286.46,286.56,286.56,286.68,286.72,286.72,285.76,284.96,284.96,284.66,284.66,284.66,284.74,284.64,284.64,284.58,285.06,285.06,284.8,286.78000000000003,286.78000000000003,286.7,286.3,286.3,285.90000000000003,284.54,284.54,283.94,285.02,287.2,287.2,287.1,285.78000000000003,285.78000000000003,284.74,284.5,284.5},{293.36,292.2,290.1,290.1,288.6,288.34000000000003,288.34000000000003,288.16,287.82,287.82,286.7,285.96,285.96,286.06,286.58,286.58,286.72,286.52,286.52,287.12,287.28000000000003,287.28000000000003,287.48,287.48,287.48,286.82,286.7,286.7,286.86,286.52,286.44,286.44,286.76,287.04,287.04,286.88,286.8,286.8,286.52,286.04,286.04,285.76,285.78000000000003,285.78000000000003,286.08,286,286,284.90000000000003,284.94,284.94,285.38,286.64,286.64,286.52,286.1,286.1,286.28000000000003,286.04,286.04,284.76,284.7,284.7,284.96,285.08,285.08,285.28000000000003,285.5,285.5,284.8,284.40000000000003,284.40000000000003},{292.5,292.5,289.5,288.38,288.38,287.98,287.44,287.44,287.16,287.28000000000003,287.28000000000003,286.56,286.08,286.08,286.2,286.2,286.2,285.84000000000003,285.94,285.94,286.46,286.62,286.62,286.74,286.22,286.22,286.44,286.92,286.92,286.82,286.7,286.7,287.1,287.58,287.58,287.24,286.7,286.7,286.26,286.28000000000003,286.28000000000003,286.42,286.46,286.46,286.6,284.8,284.8,284.22,285.22,285.22,285.82,286.94,286.94,286.90000000000003,287.06,287.06,286.16,285.56,285.56,285,284.78000000000003,284.78000000000003,284.6,284.84000000000003,284.84000000000003,284.7,284.98,284.72,284.72,284.5,284.6},{289.58,289.58,288.6,288.12,288.12,288.14,287.54,287.54,286.88,286.86,286.86,286.38,286.04,286.04,285.74,285.42,285.42,285.08,285.12,285.12,285.5,286.08,286.08,286.28000000000003,286.42,286.42,286.7,286.86,286.86,286.86,287,287,287.22,287.38,287.38,287.5,287.12,286.24,286.24,285.66,286.14,286.14,286.42,286.5,286.5,285.34000000000003,284.56,284.56,284.82,285.8,285.8,286.08,285.38,285.38,285.42,284.82,284.82,284.78000000000003,285.08,285.08,284.94,284.18,284.18,284.64,285.04,285.04,285.28000000000003,284.98,284.98,284.42,284.48},{287.18,287.18,287.24,287.92,287.92,288.64,287.78000000000003,287.40000000000003,287.40000000000003,286.96,286.26,286.26,285.74,285.42,285.42,285.1,284.88,284.88,285.6,286.14,286.14,286.66,286.86,286.86,286.76,286.6,286.6,286.72,286.48,286.48,286.90000000000003,287.18,287.18,286.84000000000003,286.22,286.22,285.76,285.7,285.7,285.16,285.48,285.48,285.78000000000003,286.1,286.1,286.02,285.58,285.58,284.96,285.74,285.74,285.7,285.08,285.08,284.64,284.58,284.58,284.68,285.14,285.14,284.64,284.24,284.24,284.34000000000003,284.58,284.58,284.6,284.22,284.22,284.04,284.34000000000003},{0,286.16,286.16,287.76,288.58,288.58,288.04,287.76,287.76,287.42,286.54,286.54,285.78000000000003,285.3,285.3,285.32,285.66,285.66,286.34000000000003,286.74,286.74,286.96,287.3,287.3,286.96,286.40000000000003,286.40000000000003,286.72,286.64,286.64,286.66,286.78000000000003,286.78000000000003,286.40000000000003,285.64,285.64,285.72,285.44,285.44,285.2,285.28000000000003,285.28000000000003,285.66,286.1,286.3,286.3,285.90000000000003,285.38,285.38,285.1,284.78000000000003,284.78000000000003,284.52,284.46,284.46,284.34000000000003,284.62,284.62,284,283.98,283.98,284.38,284.24,284.24,284.44,284.52,284.52,284.34000000000003,284.22,284.22,284.16},{0,287.02,287.02,287.8,288.2,288.2,288.12,287.62,287.62,287.26,286.88,286.88,286.02,285.92,286,286,286.32,286.8,286.8,287.34000000000003,286.94,286.94,287.3,286.82,286.82,286.56,286.62,286.62,286.7,286.86,286.86,286.48,286.2,286.2,286.22,286.22,286.22,285.76,285.58,285.58,286.02,286.48,286.48,286.52,286.12,286.12,285.76,285.44,285.44,285.18,285.06,285.06,284.76,284.78000000000003,284.78000000000003,284.6,284.58,284.58,284.34000000000003,284.24,284.24,284.66,284.46,284.46,284.48,284.88,284.88,285.28000000000003,284.7,284.7,0},{0,287.58,287.44,287.44,287.84000000000003,288.54,288.54,287.34000000000003,286.76,286.76,286.66,286.48,286.48,286.28000000000003,286.06,286.06,286.38,286.66,286.66,287.26,286.82,286.82,287.16,287.08,287.08,286.68,286.78000000000003,286.78000000000003,286.84000000000003,287.04,287.04,286.52,286.24,286.24,286.28000000000003,286.2,286.2,285.90000000000003,286.08,286.08,287.02,286.66,286.66,286.02,285.66,285.66,285.6,285.7,285.6,285.6,285.36,285,285,284.7,284.82,284.82,284.92,284.78000000000003,284.78000000000003,284.84000000000003,284.84000000000003,284.84000000000003,284.64,284.68,284.68,284.54,284.72,284.72,284.46,284.32,0},{0,287.5,287.22,287.22,287.94,287.84000000000003,287.84000000000003,287.46,286.92,286.92,286.54,286.7,286.7,286.68,286.14,286.14,286.34000000000003,286.74,286.74,287.04,287.06,287.06,287.06,287.16,287.08,287.08,287.14,287.28000000000003,287.28000000000003,287.1,286.44,286.44,285.82,285.82,285.82,286.12,285.92,285.92,286.2,286.68,286.68,286.72,286.42,286.42,286.14,285.96,285.96,285.82,285.66,285.66,285.62,285.42,285.42,284.78000000000003,284.82,284.82,284.94,285,285,284.92,284.48,284.48,284.72,284.92,284.92,284.86,284.86,284.86,284.64,284.36,0},{0,286.6,287.26,287.74,287.74,287.94,287.34000000000003,287.34000000000003,287.16,286.38,286.38,286.96,286.82,286.82,286.28000000000003,286.54,286.54,287.08,287.22,287.22,287.18,287.34000000000003,287.34000000000003,287.3,287.04,287.04,287.34000000000003,287.52,287.52,287.46,286.96,286.96,286.2,285.98,285.98,286.02,285.96,285.96,285.96,286.14,286.14,286.06,286.06,286.06,286.1,286,286,285.78000000000003,285.46,285.46,285.12,284.58,284.58,284.72,284.94,284.96,284.96,284.86,284.66,284.66,284.24,284.56,284.56,284.92,285.12,285.12,284.88,284.52,284.52,284.38,0},{0,286.32,287.08,287.64,287.64,287.82,288.12,288.12,287.6,286.42,286.42,286.7,286.78000000000003,286.78000000000003,286.82,287.06,287.06,286.68,286.52,286.52,286.98,287.38,287.38,287.24,287.02,287.02,287.54,287.54,287.56,287.56,287.40000000000003,286.16,286.16,285.72,286.08,286.08,286,285.96,285.96,286.22,286.38,286.38,286.22,285.90000000000003,285.90000000000003,285.7,285.48,285.48,285.08,284.82,284.82,284.88,285.16,285.16,285.26,285.08,285.08,284.96,284.62,284.62,284.48,284.76,284.76,285.22,285.6,285.6,285.12,284.90000000000003,284.90000000000003,284.6,0},{0,286.78000000000003,286.78000000000003,287.04,286.86,286.86,287.48,287.06,287.06,286.28000000000003,286.02,286.02,286.44,286.44,286.44,286.88,286.92,286.92,286.78000000000003,287,287,287.68,287.06,287.06,286.48,286.52,286.52,286.94,287.2,287.2,286.92,285.3,285.3,285.40000000000003,285.54,285.54,285.74,286.06,286.06,286.6,287.2,287.2,287.06,286.74,286.74,286.2,285.48,285.48,285.06,284.98,284.98,284.96,284.72,284.72,285.72,285.26,285.26,285.06,284.72,284.68,284.68,285.34000000000003,285.1,285.1,285.92,285.90000000000003,285.90000000000003,285.84000000000003,285.72,285.72,0},{0,286,286,286.14,286.1,286.1,286.8,286.94,286.94,286.38,286.04,286.04,286.1,286.12,286.12,286.26,286.84000000000003,286.84000000000003,287,287.18,287.18,287.8,287.32,287.32,286.46,285.64,285.64,285.44,286.44,286.44,286.12,285.18,284.7,284.7,284.92,285.88,285.88,286.94,287.22,287.22,287.44,287.22,287.22,286.7,286.40000000000003,286.40000000000003,286.08,285.6,285.6,286.54,285.36,285.36,284.52,284.7,284.7,285.04,285.18,285.18,284.98,285.24,285.24,285.6,284.94,284.94,284.8,285.52,285.52,286.36,286.48,286.48,0},{0,286.48,286.48,286.42,286.1,286.1,286.54,286.26,285.8,285.8,285.72,285.82,285.82,285.62,286.06,286.06,286.64,287.96,287.96,287.98,287.82,287.82,287.44,286.90000000000003,286.90000000000003,286.26,285.1,285.1,285.1,285.12,285.12,284.76,284.68,284.68,285.94,287.42,287.42,288,287.68,287.68,287.04,287.06,287.06,286.90000000000003,286.64,286.64,286.56,285.8,285.8,288.22,286.84000000000003,286.84000000000003,285.54,285.42,285.42,285.94,286.36,286.36,286.04,286.22,286.22,286.3,285.8,285.8,285.08,285.32,285.98,285.98,286.48,286.26,0},{0,286.3,286.18,286.18,286.02,285.84000000000003,285.84000000000003,285.46,285.04,285.04,284.98,285.56,285.56,285.36,285.88,285.88,287.7,288.32,288.32,288,287.48,287.48,287.06,287.06,287.06,286.32,285.06,285.06,284.5,284.5,284.5,284.32,284.58,284.58,286.92,287.64,287.64,287.16,287.14,287.14,287.14,286.88,286.78000000000003,286.78000000000003,286.5,286.3,286.3,286.56,288.06,288.06,288.58,286.86,286.86,286.52,286.68,286.68,286.64,286.54,286.54,286.5,286.48,286.48,286.3,286.04,286.04,288.2,286.56,286.56,286,286.12,0},{0,286.64,285.88,285.88,285.38,285.26,285.26,284.90000000000003,284.7,284.7,285.32,285.78000000000003,285.78000000000003,286.2,286.84000000000003,288.28000000000003,288.28000000000003,288.34000000000003,288.2,288.2,287.56,287.04,287.04,286.96,286.34000000000003,286.34000000000003,285.36,284.48,284.48,284.26,284.04,284.04,285.24,286.54,286.54,287.22,287.36,287.36,287.24,287.26,287.26,286.76,286.54,286.54,286.48,286.46,286.46,286.52,287.04,287.04,289.48,288.16,288.16,286.74,286.16,286.16,286.34000000000003,286.48,286.48,286.24,285.88,285.88,285.88,286.54,286.54,288.1,287.8,287.8,286.40000000000003,286.34000000000003,0},{0,287.2,286.2,285.12,285.12,284.84000000000003,284.88,284.88,284.98,285.46,285.46,285.88,286.16,286.16,287.32,288.2,288.2,287.96,287.92,287.92,287.62,287.32,287.32,286.96,286.42,286.42,285.6,284.8,284.8,285.08,285.14,285.14,285.5,286.16,286.16,286.66,287.32,287.32,287.32,287.82,287.82,287.24,286.7,286.52,286.52,286.6,286.84000000000003,286.84000000000003,285.96,288.42,288.42,288.86,287.42,287.42,286,286.22,286.22,286.42,286.66,286.66,285.94,285.78000000000003,285.78000000000003,286.26,287.36,287.36,287.40000000000003,286.66,286.66,286.22,0},{0,287.06,285.64,284.62,284.62,284.42,284.86,284.86,285.26,285.5,285.5,286.56,286.42,286.42,287.72,288.12,288.12,287.78000000000003,287.56,287.38,287.38,287.26,287.52,287.52,286.46,285.76,285.76,285.34000000000003,285.36,285.36,285.5,285.66,285.66,286.6,286.96,286.96,287.38,287.36,287.36,287.3,287.02,287.02,286.68,286.36,286.36,286.42,286.54,286.54,285.78000000000003,286.42,286.42,287.96,288.78000000000003,288.78000000000003,286.8,286.68,286.68,286.6,286.40000000000003,286.40000000000003,286.12,285.58,285.58,285.8,286.28000000000003,286.28000000000003,285.72,285.18,285.18,285.56,0},{0,285.16,285.16,284.3,284.06,284.06,284.52,285.1,285.1,285.6,286.58,286.58,287,288,288,288.34000000000003,287.96,287.96,287.62,286.90000000000003,286.90000000000003,285.92,286.46,286.46,286.54,286.22,286.22,285.7,285.2,285.2,286.02,286.02,286.02,287.32,287.62,287.62,287.66,287.58,287.58,287.40000000000003,287.28000000000003,287.28000000000003,286.8,286.28000000000003,286.28000000000003,286.28000000000003,286.22,286.22,285.90000000000003,285.78000000000003,287.14,287.14,287.54,287.02,287.02,286.22,286.46,286.46,286.86,286.66,286.66,286.18,285.68,285.68,285.52,285.62,285.62,285.58,284.62,284.62,0},{0,285.08,285.08,284.6,284.74,284.74,285.44,285.48,285.48,285.98,286.72,286.72,287.38,287.84000000000003,287.84000000000003,287.88,288.1,288.1,287.84000000000003,286.90000000000003,286.90000000000003,286.34000000000003,286.48,286.48,286.46,286.14,285.96,285.96,284.84000000000003,286.08,286.08,286.48,287,287,287.42,287.44,287.44,287.6,287.26,287.26,286.90000000000003,286.52,286.52,286.24,285.98,285.98,285.72,285.74,285.74,285.92,285.5,285.5,285.04,285.52,285.52,285.08,285.04,285.04,285.36,286.08,286.08,286.44,285.78000000000003,285.78000000000003,285.04,285.16,285.16,285.64,285.78000000000003,285.78000000000003,0},{0,285.22,285.22,284.72,284.68,284.88,284.88,285.16,285.94,285.94,287.2,287.84000000000003,287.84000000000003,287.98,287.5,287.5,287.18,287.2,287.2,287.2,286.90000000000003,286.90000000000003,286.48,286.32,286.32,286.7,286.48,286.48,285.58,285.46,285.46,286.6,286.76,286.76,287.46,287.42,287.42,287.44,287.18,287.18,286.40000000000003,285.72,285.72,285.76,285.24,285.24,285.46,285.98,285.98,286.40000000000003,286.64,286.64,286.08,285.04,284.84000000000003,284.84000000000003,285.1,285.54,285.54,285.92,286.06,286.06,285.32,284.82,284.82,285.06,285.36,285.36,285.58,285.5,0},{0,0,284.8,284.8,284.74,284.74,284.74,285,286.06,286.06,287.7,288.08,288.08,287.86,287.22,287.22,286.92,287.1,287.1,287.16,286.8,286.8,286.2,286.24,286.24,286.78000000000003,286.94,286.94,286.34000000000003,285.44,285.98,285.98,286.22,286.48,286.48,287.12,287.5,287.5,287.36,286.58,286.58,286.04,285.66,285.66,285.64,285.96,285.96,286.24,286.34000000000003,286.34000000000003,286.36,285.24,285.24,284.88,285.42,285.42,285.98,285.82,285.82,286.06,286.62,286.62,285.78000000000003,285.22,285.22,285.16,285.22,285.22,285.2,285.38,0},{0,0,285.12,285.12,285.92,285.66,285.66,286.24,287.34000000000003,287.88,287.88,287.98,287.74,287.74,287.32,287.1,287.1,287.04,286.64,286.64,286.24,285.94,285.94,285.88,286.16,286.16,286.52,287.04,287.04,286.12,285.46,285.46,285.6,285.7,285.7,286.42,287.18,287.18,287.1,286.42,286.42,285.82,285.66,285.66,285.78000000000003,285.7,285.7,285.68,286.18,286.18,285.98,285.36,285.36,285.26,286.18,286.18,286.22,285.34000000000003,285.98,285.98,286.14,285.90000000000003,285.90000000000003,285.5,284.96,284.96,285.04,284.84000000000003,284.84000000000003,0,0},{0,0,286.2,287.78000000000003,287.78000000000003,287.36,287.08,287.08,287.94,287.86,287.86,287.84000000000003,287.24,287.24,287.02,286.76,286.76,286.02,285.42,285.42,285.6,286,286,286.52,287.02,287.02,287.24,287.12,287.12,286.54,285.64,285.64,285.38,285.84000000000003,285.84000000000003,286.78000000000003,287.2,286.78000000000003,286.78000000000003,285.8,285,285,285.16,285.7,285.7,285.86,285.76,285.76,286.2,286.26,286.26,285.7,285.8,285.8,286.26,285.68,285.68,285.28000000000003,285.58,285.58,285.76,285.36,285.36,285.36,285.68,285.68,285.16,284.72,284.72,0,0},{0,0,288.12,288.52,288.52,288.40000000000003,287.44,287.44,288.06,287.74,287.74,286.90000000000003,286.44,286.44,286.38,286.38,286.34000000000003,286.34000000000003,286.26,285.98,285.98,286.7,287.12,287.12,287.24,287.08,287.08,286.90000000000003,286.62,286.62,286.46,285.64,285.64,285.54,286.2,286.2,287.06,287.06,287.06,285.5,284.54,284.54,285,285.48,285.48,285.84000000000003,286.12,286.12,286.36,286.48,286.48,285.64,286.04,286.04,286.16,285.6,285.6,285.1,285.06,285.06,285.5,285.3,285.12,285.12,285.82,285.98,285.98,285.28000000000003,284.76,0,0},{0,0,288.64,288.7,288.2,288.2,287.64,287.36,287.36,287.08,286.86,286.86,286.66,286.24,286.24,286.28000000000003,286.28000000000003,286.28000000000003,286.24,286.54,286.54,286.92,287.2,287.2,287.12,287.3,287.3,287.32,287.06,287.06,286.62,285.88,285.88,285.24,285.6,285.6,286.72,287.52,287.52,286.16,285.62,285.42,285.42,285.58,285.94,285.94,286.22,286.44,286.44,286.16,285.76,285.76,285.98,286.28000000000003,286.28000000000003,285.92,285.06,285.06,284.66,285.24,285.24,285.5,285.32,285.32,285.28000000000003,285.58,285.58,285.76,285.38,0,0},{0,0,287.52,287.8,287.86,287.86,287.44,286.82,286.82,286.5,286.66,286.66,286.62,286.5,286.5,286.68,286.72,286.72,287.02,287.40000000000003,287.14,287.14,287.18,286.62,286.62,286.8,286.68,286.68,286.38,286.22,286.22,286.40000000000003,285.56,285.56,285.82,286.76,286.76,287.26,287.1,287.1,286.7,286.1,286.1,285.92,286.14,286.14,286.3,286.22,286.22,286.3,286.36,286.36,286.12,286.12,286.12,285.88,285.74,285.74,285.48,285.64,285.64,285.66,285.24,285.24,285.04,284.8,285.1,285.1,284.94,0,0},{0,0,287.46,287.46,287.42,287.3,287.3,286.68,286.48,286.48,286.8,287.38,287.38,287.52,287.08,287.08,286.72,286.96,286.96,287.14,286.58,286.58,285.74,285.68,285.68,286.32,286.82,286.82,287.02,287.06,287.06,287.16,286.34000000000003,286.34000000000003,286.46,286.98,286.98,287.1,286.78000000000003,286.78000000000003,286.5,285.94,285.94,286.08,285.96,285.86,285.86,285.84000000000003,285.7,285.7,285.54,285.62,285.62,285.90000000000003,285.90000000000003,285.90000000000003,285.94,285.92,285.92,285.7,285.2,285.2,284.98,285.18,285.18,285.2,285.16,285.16,284.8,0,0},{0,0,288.2,288.2,289.12,287.74,287.74,287.08,286.88,286.88,286.86,286.62,286.62,286.18,286.44,286.44,285.84000000000003,286.58,286.58,286.66,285.94,285.94,285.3,286,287.42,287.42,287.46,287.5,287.5,287.3,286.7,286.7,286.54,287.04,287.04,287.04,286.6,286.6,285.92,285.46,285.46,285.16,285.42,285.42,285.72,285.7,285.7,285.68,285.92,285.92,285.88,286.02,286.02,286.18,286.06,286.06,285.90000000000003,286.16,286.16,286.16,285.86,285.86,285.56,285.16,285.16,285.36,285.46,285.46,285.14,0,0},{0,0,289.2,289.2,289.68,288.92,287.64,287.64,286.98,286.98,286.98,286.26,285.48,285.48,285.06,285.78000000000003,285.78000000000003,286.42,286.28000000000003,286.28000000000003,285.74,285.68,285.68,286.36,287,287,287.3,287.32,287.32,286.94,286.56,286.56,286.7,287.1,287.1,286.3,286.02,286.02,285.58,285.3,285.3,285.54,286.2,286.2,286.22,286.18,286.18,285.66,285.56,285.94,285.94,285.72,285.88,285.88,285.74,285.58,285.58,285.6,285.82,285.82,286.2,286.18,286.18,285.14,284.82,284.82,285,285.32,285.32,0,0}}\"^^xsd:string")); //xsd:array is not availabel
//    }


//    @Test
//    public void checkBBOX(){
//                + "PREFIX rasdb:\t<http://www.semanticweb.org/RasterDataCube/>\n"
//                + "SELECT * {\n"
//              + "?r rdfs:label ?region_name .\n"
//                + "?r geo:asWKT ?regionBBOX .\n"
//                + "?x rasdb:hasRasterName ?raster_name .\n"
//                + ?x rasdb:hasRasterBBOX /\n"
//                + "BIND (rasdb:rasCheckBBOX(Raster?regionBBOX, ?rasterBBOX) AS ?v)"
//                + "}\n";
//
//        executeAndCompareValues(query2, ImmutableList.of("\"array\"^^xsd:string"));
//    }

}
